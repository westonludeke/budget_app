<% if (aggregatedData && aggregatedData.length > 0) { %>
  <h2>Expense Report for <%= closeDate %></h2>
  <% aggregatedData.forEach(monthData => { %>
    <div class="card mb-3">
      <div class="card-header"><%= monthData._id %></div>
      <div class="card-body">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Category</th>
              <th class="text-right">Total</th>
            </tr>
          </thead>
          <tbody>
            <% let monthTotal = 0; %>
            <% monthData.categories.forEach(category => { %>
              <tr>
                <td><%= category.category || 'Uncategorized' %></td>
                <td class="text-right">$<%= category.total.toFixed(2) %></td>
              </tr>
              <% monthTotal += category.total; %>
            <% }); %>
            <tr class="table-active">
              <th>Total</th>
              <th class="text-right">$<%= monthTotal.toFixed(2) %></th>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  <% }); %>
<% } else { %>
  <div class="alert alert-info">No data available for the selected date range.</div>
<% } %>